<?php include('../config/con.php'); ?>

<!DOCTYPE html>
<html lang="en">


<head>
  <!-- ========== Meta Tags ========== -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Agrul - Organic Farm Agriculture Template">

  <!-- ========== Page Title ========== -->
  <title>Rich Farms | Blog</title>

  <!-- ========== Favicon Icon ========== -->
  <link rel="shortcut icon" href="../assets/img/favicon.png" type="image/x-icon">

  <!-- ========== Start Stylesheet ========== -->
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/css/font-awesome.min.css" rel="stylesheet">
  <link href="../assets/css/themify-icons.css" rel="stylesheet">
  <link href="../assets/css/elegant-icons.css" rel="stylesheet">
  <link href="../assets/css/flaticon-set.css" rel="stylesheet">
  <link href="../assets/css/magnific-popup.css" rel="stylesheet">
  <link href="../assets/css/swiper-bundle.min.css" rel="stylesheet">
  <link href="../assets/css/animate.css" rel="stylesheet">
  <link href="../assets/css/validnavs.css" rel="stylesheet">
  <link href="../assets/css/helper.css" rel="stylesheet">
  <link href="../assets/css/shop.css" rel="stylesheet">
  <link href="../assets/css/style.css" rel="stylesheet">
  <link href="../assets/css/unit-test.css" rel="stylesheet">
  <link href="../style.css" rel="stylesheet">
  <!-- ========== End Stylesheet ========== -->

</head>

<body>

  <!--[if lte IE 9]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->

  <!-- Preloader Start -->
  <!-- <div class="se-pre-con"></div> -->
  <!-- Preloader Ends -->

  <!-- Start Header Top 
    ============================================= -->
  <div class="top-bar-area top-bar-style-one bg-dark text-light">
    <div class="container">
      <div class="row align-center">
        <div class="col-xl-6 col-lg-8 offset-xl-3 pl-30 pl-md-15 pl-xs-15">
          <ul class="item-flex">
            <li>
              <i class="fas fa-map-marker-alt"></i> Dir. of Agric. Building
                Complex, Gwagwalada Area Council Secretariat, FCT.
            </li>
          </ul>
        </div>
        <div class="col-xl-3 col-lg-4 text-end">
          <div class="social">
            <ul>
              <li>
                <a href="#">
                  <i class="fab fa-facebook-f"></i>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- End Header Top -->

  <header>
    <!-- Start Navigation -->
    <nav
      class="navbar mobile-sidenav navbar-style-one navbar-sticky navbar-default validnavs white navbar-fixed no-background">
      <div class="container">
        <div class="row align-center">
          <!-- Start Header Navigation -->
          <div class="col-xl-2 col-lg-3 col-md-2 col-sm-1 col-1">
            <div class="navbar-header">
              <button
                type="button"
                class="navbar-toggle"
                data-toggle="collapse"
                data-target="#navbar-menu">
                <i class="fa fa-bars"></i>
              </button>
              <a class="navbar-brand" href="/">
                <img src="../assets/img/fam-logo.png" class="logo" alt="Logo" />
              </a>
            </div>
          </div>
          <!-- End Header Navigation -->

          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="col-xl-6 offset-xl-1 col-lg-6 col-md-4 col-sm-4 col-4">
            <div class="collapse navbar-collapse" id="navbar-menu">
              <img src="../assets/img/logo.png" alt="Logo" />
              <button
                type="button"
                class="navbar-toggle"
                data-toggle="collapse"
                data-target="#navbar-menu">
                <i class="fa fa-times"></i>
              </button>

              <ul
                class="nav navbar-nav navbar-center"
                data-in="fadeInDown"
                data-out="fadeOutUp">
                <li>
                  <a href="/">Home</a>
                </li>
                <li>
                  <a href="/about-us/">About</a>
                </li>
                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Projects</a>
                  <ul class="dropdown-menu">
                    <li><a href="../project-app.html">Apples</a></li>
                    <li><a href="../project-landscape.html">Landscape</a></li>
                    <li><a href="../project-livestocks.html">Livestocks</a></li>
                    <li><a href="../project-vegetables.html">Vegetables</a></li>
                    <li>
                      <a href="../project-dehydration.html">Dehydration Machines</a>
                    </li>
                    <li><a href="project-other.html">Other Machines</a></li>
                    <li><a href="../empowerment.html">Empowerment</a></li>
                  </ul>
                </li>
                <li><a href=".#">Blog</a></li>

                <li><a href="../contact-us.html">contact</a></li>
              </ul>
            </div>
          </div>
          <!-- /.navbar-collapse -->

          <div class="col-xl-3 col-lg-3 col-md-6 col-sm-7 col-7">
            <div class="attr-right">
              <!-- Start Atribute Navigation -->
              <div class="attr-nav">
                <ul>
                  <li class="contact">
                    <div class="call">
                      <div class="icon">
                        <i class="fas fa-comments-alt-dollar"></i>
                      </div>
                      <div class="info">
                        <p>Have any Questions?</p>
                        <h5>
                          <a href="mailto:info@crysta.com">info@richfarmsfcta.org</a>
                        </h5>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
              <!-- End Atribute Navigation -->
            </div>
          </div>
        </div>
        <!-- Main Nav -->

        <!-- Overlay screen for menu -->
        <div class="overlay-screen"></div>
        <!-- End Overlay screen for menu -->
      </div>
    </nav>
    <!-- End Navigation -->
  </header>
  <!-- End Header -->
  <!-- End Header -->

  <!-- Start Breadcrumb 
    ============================================= -->
  <div class="breadcrumb-area text-center shadow dark bg-fixed text-light" style="background-image: url(../assets/img/banner/3.jpg);">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <h1>Blog</h1>
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
              <li class="active">Blog</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>
  <!-- End Breadcrumb -->

  <!-- Start Blog
    ============================================= -->
  <div class="blog-area full-blog default-padding">
    <div class="container">
      <div class="blog-items">
        <div class="row">
          <div class="blog-content col-xl-8 col-lg-7 col-md-12 pr-35 pr-md-15 pl-md-15 pr-xs-15 pl-xs-15">


            <?php

            // Validate and sanitize the postid
            $post_id = isset($_GET['postid']) ? intval($_GET['postid']) : 0;

            if ($post_id > 0) {
              // Query to get post details along with images in one go
              $sqlPostImages = "
                              SELECT p.title, p.content, p.created_at, pi.image_path 
                              FROM post p
                              LEFT JOIN post_images pi ON p.postid = pi.postid
                              WHERE p.postid = ?";

              // Prepare the statement
              $stmt = $conn->prepare($sqlPostImages);
              $stmt->bind_param("i", $post_id);
              $stmt->execute();
              $result = $stmt->get_result();

              // Check if the post exists
              if ($result->num_rows > 0) {
                $images = [];  // Array to store images
                $postTitle = $postContent = '';

                // Fetching the post and its images
                while ($row = $result->fetch_assoc()) {
                  $postTitle = $row['title'];    // Set post title
                  $postContent = $row['content']; // Set post content

                  $timestamp = strtotime($row['created_at']);
                  $day = date('d', $timestamp);  // Day (e.g., 23)
                  $month = date('F', $timestamp); // Full month name (e.g., September)
                  $year = date('Y', $timestamp);  // Year (e.g., 2024)

                  if ($row['image_path']) {
                    $images[] = $row['image_path']; // Collect images
                  }
                }
            ?>


                <div class="blog-style-two item">
                  <div class="thumb">
                    <a href="blog-single-with-sidebar.html"><img src="../uploads/<?php echo htmlspecialchars($images[0]); ?>" alt="Thumb"></a>
                    <div class="date"><strong><?php echo $day; ?></strong> <span><?php echo $month . ", " . $year; ?></span></div>
                  </div>
                  <div class="info">
                    <div class="meta">
                      <ul>
                        <li>
                          <a href="#"><i class="fas fa-user-circle"></i> Admin</a>
                        </li>
                      </ul>
                    </div>
                    <h3><?php echo htmlspecialchars($postTitle); ?></h3>
                    <p class="text-justify">
                      <?php echo htmlspecialchars($postContent); ?>
                    </p>
                    <style>
                      .thumb-image:hover {
                        top: -50px;
                        left: -35px;
                        width: 50%;
                        position: relative;
                        transform: scale(1.1);
                        transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1);
                      }

                      .thumb-image {
                        width: 200px;
                        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                      }
                    </style>
                    <?php
                    // Display the images
                    echo "<div class='post-images'>";
                    if (count($images) > 0) {
                      foreach ($images as $image) {
                        // Assuming your images are stored in the "uploads/" folder
                    ?>
                        <?php
                        echo "<img src='../uploads/" . htmlspecialchars($image) . "' alt='Post Image' style='margin: 10px;' class='thumb-image'>";
                        ?>

                  <?php
                      }
                    } else {
                      echo "<p>No images for this post.</p>";
                    }
                    echo "</div>";
                  } else {
                    echo "<p>Post not found.</p>";
                  }
                  ?>

                  </div>
                </div>

              <?php
              // Close statement and connection
              $stmt->close();
            } else {
              echo "<p>Invalid post ID.</p>";
            }
            $conn->close();
              ?>








          </div>


          <!-- Start Sidebar -->
          <div class="sidebar col-xl-4 col-lg-5 col-md-12 mt-md-50 mt-xs-50">
            <?php include('aside.php'); ?>
          </div>
          <!-- End Start Sidebar -->
        </div>
      </div>
    </div>
  </div>
  <!-- End Blog -->

  <!-- Start Footer 
    ============================================= -->
  <footer
    class="bg-dark text-light"
    style="background-image: url(../assets/img/shape/brush-down.png)">
    <div class="container">
      <!-- Start Footer Bottom -->
      <div class="footer-bottom">
        <div class="row">
          <div class="col-lg-6">
            <p>
              &copy; Copyright
              <script>
                document.write(new Date().getFullYear());
              </script>
              . All Rights Reserved.
            </p>
          </div>
          <div class="col-lg-6 text-end">
            <ul>
              <li>
                <a href="../about-us">About us</a>
              </li>
              <li>
                <a href="../contact-us.html">Support</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <!-- End Footer Bottom -->
    </div>
    <div class="shape-right-bottom">
      <img src="../assets/img/shape/10.png" alt="Image Not Found" />
    </div>
    <div class="shape-left-bottom">
      <img src="../assets/img/shape/11.png" alt="Image Not Found" />
    </div>
  </footer>
  <!-- End Footer -->

  <!-- jQuery Frameworks
    ============================================= -->
  <script src="../assets/js/jquery-3.6.0.min.js"></script>
  <script src="../assets/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/jquery.appear.js"></script>
  <script src="../assets/js/jquery.easing.min.js"></script>
  <script src="../assets/js/jquery.magnific-popup.min.js"></script>
  <script src="../assets/js/modernizr.custom.13711.js"></script>
  <script src="../assets/js/swiper-bundle.min.js"></script>
  <script src="../assets/js/wow.min.js"></script>
  <script src="../assets/js/progress-bar.min.js"></script>
  <script src="../assets/js/circle-progress.js"></script>
  <script src="../assets/js/isotope.pkgd.min.js"></script>
  <script src="../assets/js/imagesloaded.pkgd.min.js"></script>
  <script src="../assets/js/jquery.nice-select.min.js"></script>
  <script src="../assets/js/count-to.js"></script>
  <script src="../assets/js/jquery.scrolla.min.js"></script>
  <script src="../assets/js/YTPlayer.min.js"></script>
  <script src="../assets/js/TweenMax.min.js"></script>
  <script src="../assets/js/validnavs.js"></script>
  <script src="../assets/js/main.js"></script>

</body>

</html>